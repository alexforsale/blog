<!DOCTYPE html>
<html lang="en">
<head>
<!-- Jun 07, 2022 -->
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Stumpwm</title>
<meta name="author" content="Kristian Alexander P" />
<meta name="generator" content="Org Mode" />
<link rel='icon' type='image/x-icon' href='/blog/images/favicon.jpg'/><meta name='viewport' content='width=device-width, initial-scale=1'><link rel='stylesheet' href='https://code.cdn.mozilla.net/fonts/fira.css'><link rel='stylesheet' href='/blog/css/site.css' type='text/css'/><link rel='stylesheet' href='/blog/css/custom.css' type='text/css'/><link rel='stylesheet' href='/blog/css/syntax-coloring.css' type='text/css'/>
<script>
// @license magnet:?xt=urn:btih:1f739d935676111cfff4b4693e3816e664797050&amp;dn=gpl-3.0.txt GPL-v3-or-Later
     function CodeHighlightOn(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.add("code-highlighted");
         target.classList.add("code-highlighted");
       }
     }
     function CodeHighlightOff(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.remove("code-highlighted");
         target.classList.remove("code-highlighted");
       }
     }
// @license-end
</script>
</head>
<body>
<div id="org-div-home-and-up">
 <a accesskey="h" href="/blog"> UP </a>
 |
 <a accesskey="H" href="/blog"> HOME </a>
</div><header id="top" class="status">
<!--TODO: update this -->
<div class='intro'>
  <img src='/blog/images/about/profile.png' alt='Kristian Alexander P' class='no-border'/>
  <h1>
    <span>Kristian Alexander</span>
  </h1>
  <p>Free Software Enthusiast | GNU Emacs User</p>
</div>

<div class='nav'>
  <ul>
    <li><a href='/'>Website</a>.</li>
    <li><a href='/blog/index.html'>Home</a>.</li>
    <li><a href='/blog/posts/index.html'>Posts</a>.</li>
    <!-- <li><a href='/blog/index.xml'>RSS</a>.</li> -->
    <li><a href='/blog/about.html'>About</a></li>
  </ul>
</div>
</header>
<main id="content" class="content">
<header>
<h1 class="title">Stumpwm</h1>
<p class="subtitle" role="doc-subtitle">Published on Mar 19, 2022 by Kristian Alexander P.</p>
</header><section id="outline-container-org822a6ac" class="outline-2">
<h2 id="org822a6ac">Configuration file</h2>
<div class="outline-text-2" id="text-org822a6ac">
<pre class="example">
header-args: :tangle ~/.config/stumpwm/config :mkdirp t
</pre>
</div>
<div id="outline-container-org22c763f" class="outline-3">
<h3 id="org22c763f">Header</h3>
<div class="outline-text-3" id="text-org22c763f">
<p>
Needed so <i>Emacs</i> will use <i>lisp major-mode</i> for this file since it&rsquo;s not using <i>.lisp</i> extension.
</p>
<div class="org-src-container">
<pre class="src src-lisp"><span class="org-comment-delimiter">;;;; </span><span class="org-comment">Stumpwm configuration file</span>
<span class="org-comment-delimiter">;;;</span>
<span class="org-comment-delimiter">;;; </span><span class="org-comment">This file is autogenerated, do not edit.</span>
<span class="org-comment-delimiter">;;; </span><span class="org-comment">see `</span><span class="org-comment"><span class="org-constant">https://java281.dynv6.net/~alexforsale/posts/Stumpwm.html</span></span><span class="org-comment">' for details</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org89c35a5" class="outline-3">
<h3 id="org89c35a5">Load <code>quicklisp</code></h3>
<div class="outline-text-3" id="text-org89c35a5">
<p>
Load my installation of <i>quicklisp</i>. The special operator <code>let</code> creates new variable <code>quicklisp-init</code> and executes a series of <i>form</i> (here just runs the <i>macro</i> <code>when</code>) that uses these <i>bindings</i>.
</p>
<div class="org-src-container">
<pre class="src src-lisp">(<span class="org-keyword">let</span> ((quicklisp-init
        (merge-pathnames <span class="org-string">".local/share/quicklisp/setup.lisp"</span> (user-homedir-pathname))))
  (<span class="org-keyword">when</span> (probe-file quicklisp-init)
    (load quicklisp-init)))
</pre>
</div>
<ul class="org-ul">
<li><code>merge-pathnames</code> is similar to <i>python</i>&rsquo;s <code>os.path.join()</code>.</li>
<li>The variable <code>user-homedir-pathname</code> returns a <a href="http://www.lispworks.com/documentation/HyperSpec/Body/26_glo_p.htm#pathname">pathname</a> without any name, type or version component (those component are all <i>nil</i>) for the user&rsquo;s home directory on <i>host (not used here)</i>.</li>
<li><code>probe-file</code> tests whether a file exists<sup><a id="fnr.1" class="footref" href="#fn.1" role="doc-backlink">1</a></sup></li>
</ul>
</div>
</div>
<div id="outline-container-org42f8d29" class="outline-3">
<h3 id="org42f8d29">load stumpwm from quicklisp</h3>
<div class="outline-text-3" id="text-org42f8d29">
<div class="org-src-container">
<pre class="src src-lisp">(ql:quickload <span class="org-builtin">:stumpwm</span>)
</pre>
</div>
</div>
</div>
<div id="outline-container-orga53d13c" class="outline-3">
<h3 id="orga53d13c">CANCELLED Swank</h3>
<div class="outline-text-3" id="text-orga53d13c">
<ul class="org-ul">
<li>State &ldquo;CANCELLED&rdquo;  from              <span class="timestamp-wrapper"><span class="timestamp">[2022-04-10 Sun 02:01] </span></span> <br>
use sly instead</li>
</ul>
<p>
Requires <code>swank</code> (from the package <code>slime</code>) in order to run the function <code>swank-loader</code>. Again I use the special operator <code>let</code> to dynamically creates the <i>stumpwm</i> command <code>swank</code>, this command can be run inside <i>stumpwm</i> for toggling <i>swank</i>.
</p>
<div class="org-src-container">
<pre class="src src-lisp">(<span class="org-keyword">require</span> <span class="org-constant">:swank</span>)
(swank-loader:init)
(<span class="org-keyword">let</span> ((server-running nil))
  (defcommand swank () ()
    <span class="org-string">"Toggle the swank server on/off"</span>
    (<span class="org-keyword">if</span> server-running
        (<span class="org-keyword">progn</span>
          (swank:stop-server 4004)
          (echo-string
           (current-screen)
           <span class="org-string">"Stopping swank."</span>)
          (setf server-running nil))
        (<span class="org-keyword">progn</span>
          (swank:create-server <span class="org-builtin">:port</span> 4004
                               <span class="org-builtin">:style</span> swank:*communication-style*
                               <span class="org-builtin">:dont-close</span> t)
          (echo-string
           (current-screen)
           <span class="org-string">"Starting swank. M-x slime-connect RET RET, then (in-package stumpwm)."</span>)
          (setf server-running t)))))
</pre>
</div>
</div>
</div>
<div id="outline-container-org6166df8" class="outline-3">
<h3 id="org6166df8">Sly</h3>
<div class="outline-text-3" id="text-org6166df8">
<p>
It has more features enabled without too much customization.
</p>
<div class="org-src-container">
<pre class="src src-lisp">(ql:quickload <span class="org-builtin">:slynk</span>)
(<span class="org-keyword">let</span> ((server-running nil))
  (defcommand slynk () ()
    <span class="org-string">"Toggle the slynk server on/off"</span>
    (<span class="org-keyword">if</span> server-running
        (<span class="org-keyword">progn</span>
          (slynk:stop-server 4003)
          (echo-string (current-screen)
                       <span class="org-string">"Stopping slynk on port 4003."</span>)
          (setf server-running nil))
        (<span class="org-keyword">progn</span>
          (slynk:create-server <span class="org-builtin">:port</span> 4003 <span class="org-builtin">:dont-close</span> t)
          (echo-string (current-screen)
                       <span class="org-string">"Starting slynk on port 4003."</span>)
          (setf server-running t)))))
</pre>
</div>
</div>
</div>
<div id="outline-container-org40348ca" class="outline-3">
<h3 id="org40348ca">Stumpwm configuration</h3>
<div class="outline-text-3" id="text-org40348ca">
<p>
The macro <code>in-package</code> causes the package named to be the current packages; that is, the value of <code>*package*</code>. In short it&rsquo;ll let us to call <code>run-shell-command</code> instead of <code>stuwmpm:run-shell-command</code>, this also works for variables.
</p>
<div class="org-src-container">
<pre class="src src-lisp">(<span class="org-keyword">in-package</span> <span class="org-builtin">:stumpwm</span>)
</pre>
</div>
<dl class="org-dl">
<dt><code>*mouse-focus-policy*</code></dt><dd><p>
This variable decide how the mouse affects input focus. Possible values are <code>:ignore</code>, <code>:sloppy</code> and <code>:click</code>.
</p>
<div class="org-src-container">
<pre class="src src-lisp">(setf *mouse-focus-policy* <span class="org-builtin">:sloppy</span>)
</pre>
</div></dd>
<dt><code>*run-or-raise-all-groups*</code></dt><dd><p>
Defines how the <code>run-or-raise</code> function searches, in this case all groups.
</p>
<div class="org-src-container">
<pre class="src src-lisp">(setf *run-or-raise-all-groups* t)
</pre>
</div></dd>
<dt><code>*run-or-raise-all-screens*</code></dt><dd><p>
Same as above, but to <i>screens</i>.
</p>
<div class="org-src-container">
<pre class="src src-lisp">(setf *run-or-raise-all-screens* t)
</pre>
</div></dd>
<dt><code>*fload-window-modifier*</code></dt><dd>The keyboard modifier to use for resize and move floating windows without clicking on the top border. Valid values are <code>:META</code> <code>:ALT</code> <code>:HYPER</code> <code>:SUPER</code>, <code>:ALTGR</code> and <code>:NUMLOCK</code>.</dd>
</dl>
</div>
</div>
<div id="outline-container-org4ac42d9" class="outline-3">
<h3 id="org4ac42d9">Functions</h3>
<div class="outline-text-3" id="text-org4ac42d9">
</div>
<div id="outline-container-org65884a3" class="outline-4">
<h4 id="org65884a3">empty-directory-p</h4>
<div class="outline-text-4" id="text-org65884a3">
<div class="org-src-container">
<pre class="src src-lisp">(<span class="org-keyword">defun</span> <span class="org-function-name">empty-directory-p</span> (path)
  (and (null (directory (concatenate 'string path <span class="org-string">"/*"</span>)))
       (null (directory (concatenate 'string path <span class="org-string">"/*/"</span>)))))
</pre>
</div>
</div>
</div>
<div id="outline-container-org6d1f2ce" class="outline-4">
<h4 id="org6d1f2ce">check is process is active</h4>
<div class="outline-text-4" id="text-org6d1f2ce">
<div class="org-src-container">
<pre class="src src-lisp">(<span class="org-keyword">defun</span> <span class="org-function-name">+config/is-active</span> (process)
  <span class="org-doc">"Returns PROCESS pid if it's active."</span>
  (<span class="org-keyword">let</span> ((+process
          (parse-integer
           (run-shell-command
            (format nil <span class="org-string">"pgrep ~A"</span> process) t) <span class="org-builtin">:junk-allowed</span> t)))
    (<span class="org-keyword">when</span> +process)
    (print +process)))
</pre>
</div>
</div>
</div>
<div id="outline-container-orgcbb5fce" class="outline-4">
<h4 id="orgcbb5fce">Determine running OS</h4>
<div class="outline-text-4" id="text-orgcbb5fce">
<p>
A simple method is by querying the output of <code>uname -s</code>:
</p>
<div class="org-src-container">
<pre class="src src-lisp">(<span class="org-keyword">defparameter</span> <span class="org-variable-name">*os*</span>
  (remove #\Newline
          (string-downcase
           (run-shell-command <span class="org-string">"uname -s"</span> t)))
  <span class="org-doc">"The currently running operating system in lowercase."</span>)
</pre>
</div>
</div>
</div>
<div id="outline-container-org818c31e" class="outline-4">
<h4 id="org818c31e">pass-to-emacsclient</h4>
<div class="outline-text-4" id="text-org818c31e">
<div class="org-src-container">
<pre class="src src-lisp">(<span class="org-keyword">defun</span> <span class="org-function-name">pass-to-emacsclient</span> (arg)
  (<span class="org-keyword">let</span> ((emacs-cmd '(<span class="org-string">"emacsclient"</span>)))
    (<span class="org-keyword">when</span> *chemacs-profile*
      (push (format nil <span class="org-string">"-s ~A"</span> *chemacs-profile*) (cdr (last emacs-cmd))))
    (push (format nil <span class="org-string">"--eval ~A"</span> arg) (cdr (last emacs-cmd)))
    (run-shell-command (format nil <span class="org-string">"~A"</span> emacs-cmd) t)))
</pre>
</div>
</div>
</div>
<div id="outline-container-orgcf00aa0" class="outline-4">
<h4 id="orgcf00aa0">emacs-emms</h4>
<div class="outline-text-4" id="text-orgcf00aa0">
<div class="org-src-container">
<pre class="src src-lisp">(<span class="org-keyword">defun</span> <span class="org-function-name">emacs-emms</span> (cmd)
  <span class="org-doc">"Runs CMD for `</span><span class="org-doc"><span class="org-constant">Emacs</span></span><span class="org-doc">'s `</span><span class="org-doc"><span class="org-constant">EMMS</span></span><span class="org-doc">'."</span>
  (<span class="org-keyword">let</span> ((is-running
          (pass-to-emacsclient <span class="org-string">"'emms-player-paused-p'"</span>)))
    (<span class="org-keyword">when</span> is-running
      (<span class="org-keyword">cond</span> ((string= (string-downcase cmd)
                      (or <span class="org-string">"play"</span> <span class="org-string">"pause"</span>))
             (pass-to-emacsclient <span class="org-string">"'(emms-pause)'"</span>))
            ((string= (string-downcase cmd)
                      <span class="org-string">"next"</span>)
             (pass-to-emacsclient <span class="org-string">"'(emms-next)'"</span>))
            ((string= (string-downcase cmd)
                      (or <span class="org-string">"prev"</span> <span class="org-string">"previous"</span>))
             (pass-to-emacsclient <span class="org-string">"'(emms-previous)'"</span>))))))
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org263b373" class="outline-3">
<h3 id="org263b373">Global Variables</h3>
<div class="outline-text-3" id="text-org263b373">
</div>
<div id="outline-container-orgb16c8af" class="outline-4">
<h4 id="orgb16c8af">chemacs</h4>
<div class="outline-text-4" id="text-orgb16c8af">
<div class="org-src-container">
<pre class="src src-lisp">(<span class="org-keyword">defparameter</span> <span class="org-variable-name">*chemacs-profile*</span> nil
  <span class="org-doc">"The current Chemacs profile"</span>)

(<span class="org-keyword">let</span> ((chemacs-profile
       (<span class="org-keyword">cond</span> ((probe-file
               (merge-pathnames
                <span class="org-string">".config/chemacs/profile"</span>
                (user-homedir-pathname)))
              (merge-pathnames
               <span class="org-string">".config/chemacs/profile"</span>
               (user-homedir-pathname)))
             ((probe-file
               (merge-pathnames
                <span class="org-string">".emacs-profile"</span>
                (user-homedir-pathname)))
              (merge-pathnames
               <span class="org-string">".emacs-profile"</span>
               (user-homedir-pathname))))))
  (<span class="org-keyword">when</span> chemacs-profile
    (setf *chemacs-profile*
          (uiop:read-file-line chemacs-profile))))
</pre>
</div>
</div>
</div>
<div id="outline-container-org0cc5828" class="outline-4">
<h4 id="org0cc5828">emacs daemon name</h4>
<div class="outline-text-4" id="text-org0cc5828">
<div class="org-src-container">
<pre class="src src-lisp">(<span class="org-keyword">if</span> *chemacs-profile*
    (<span class="org-keyword">defvar</span> <span class="org-variable-name">*emacs-daemon-name*</span> *chemacs-profile*)
  (<span class="org-keyword">defvar</span> <span class="org-variable-name">*emacs-daemon-name*</span> <span class="org-string">"default"</span>))
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org037e2a4" class="outline-3">
<h3 id="org037e2a4">Load contrib modules</h3>
<div class="outline-text-3" id="text-org037e2a4">
<p>
Check several directories for modules, and add it to the <i>stumpwm</i> module-dir using the function <code>set-module-dir</code>.
</p>
<div class="org-src-container">
<pre class="src src-lisp">(<span class="org-keyword">let</span> ((module-dir
        (or (probe-file <span class="org-string">"/usr/share/stumpwm/contrib"</span>)
            (probe-file <span class="org-string">"/usr/local/share/stumpwm/contrib"</span>)
            (probe-file (merge-pathnames <span class="org-string">".local/share/stumpwm/contrib"</span>
                                         (user-homedir-pathname)))
            (probe-file (merge-pathnames <span class="org-string">".config/stumpwm/modules"</span>
                                         (user-homedir-pathname))))))
  (set-module-dir module-dir))
</pre>
</div>
<p>
The <i>modules</i> directory itself is a git repository of the <a href="https://github.com/stumpwm/stumpwm-contrib.git">stumpwm-contrib</a>. Currently the only dependency from the <i>contrib</i> modules is <a href="https://github.com/stumpwm/stumpwm-contrib/blob/master/util/stumpish/stumpish">stumpish</a>, an interactive shell for <i>stumpwm</i>.
</p>
<div class="org-src-container">
<pre class="src src-sh"><span class="org-keyword">if ! </span><span class="org-builtin">test</span> -d ~/.config/stumpwm/modules; <span class="org-keyword">then</span>
    git clone https://github.com/stumpwm/stumpwm-contrib.git ~/.config/stumpwm/modules
<span class="org-keyword">fi</span>
</pre>
</div>
<p>
Also create a symlink for <i>stumpish</i> to <code>~/.local/bin</code>
</p>
<div class="org-src-container">
<pre class="src src-sh">[ <span class="org-negation-char">!</span> -d ~/.local/bin ] &amp;&amp; mkdir -p ~/.local/bin
pushd ~/.local/bin
[ <span class="org-negation-char">!</span> -L stumpish ] &amp;&amp; ln -sv ../../.config/stumpwm/modules/util/stumpish/stumpish stumpish
popd
</pre>
</div>
</div>
<div id="outline-container-org154f29f" class="outline-4">
<h4 id="org154f29f">additional module directory</h4>
<div class="outline-text-4" id="text-org154f29f">
<p>
This is for personal module
</p>
</div>
<ul class="org-ul">
<li><a id="orge5b4bb6"></a>Set the variable<br>
<div class="outline-text-5" id="text-orge5b4bb6">
<p>
Use this variable to set the directory, if there&rsquo;s more than one directory, consider keep them inside one single directory and add the parent directory instead, since the <code>set-module-dir</code> function is recursive.
</p>
<div class="org-src-container">
<pre class="src src-lisp">(<span class="org-keyword">defvar</span> <span class="org-variable-name">*additional-module-dir*</span> <span class="org-string">"~/Projects/lisp/playerctl-mode-line"</span>)
</pre>
</div>
</div>
</li>
<li><a id="org0c76949"></a>add when not empty<br>
<div class="outline-text-5" id="text-org0c76949">
<div class="org-src-container">
<pre class="src src-lisp">(<span class="org-keyword">when</span> (not (empty-directory-p *additional-module-dir*))
  (set-module-dir *additional-module-dir*))
</pre>
</div>
</div>
</li>
</ul>
</div>
</div>
<div id="outline-container-org99de3f8" class="outline-3">
<h3 id="org99de3f8">Colors</h3>
<div class="outline-text-3" id="text-org99de3f8">
<p>
Set the default color to <code>base16-materia</code>, palette from <code>wal</code> as a fallback if there&rsquo;s no <code>wal</code> cache file yet.
</p>
<div class="org-src-container">
<pre class="src src-lisp">(<span class="org-keyword">defvar</span> <span class="org-variable-name">default-colors</span>
  '(<span class="org-string">"#263238"</span>
    <span class="org-string">"#EC5F67"</span>
    <span class="org-string">"#8BD649"</span>
    <span class="org-string">"#FFCC00"</span>
    <span class="org-string">"#89DDFF"</span>
    <span class="org-string">"#82AAFF"</span>
    <span class="org-string">"#80CBC4"</span>
    <span class="org-string">"#CDD3DE"</span>
    <span class="org-string">"#707880"</span>
    <span class="org-string">"#EC5F67"</span>
    <span class="org-string">"#8BD649"</span>
    <span class="org-string">"#FFCC00"</span>
    <span class="org-string">"#89DDFF"</span>
    <span class="org-string">"#82AAFF"</span>
    <span class="org-string">"#80CBC4"</span>
    <span class="org-string">"#FFFFFF"</span>))
</pre>
</div>
</div>
<div id="outline-container-orgf96bb4c" class="outline-4">
<h4 id="orgf96bb4c">set the wal file</h4>
<div class="outline-text-4" id="text-orgf96bb4c">
<div class="org-src-container">
<pre class="src src-lisp">(<span class="org-keyword">defvar</span> <span class="org-variable-name">wal-colors-path</span> <span class="org-string">"~/.cache/wal/colors"</span>)
</pre>
</div>
</div>
</div>
<div id="outline-container-org1ae1115" class="outline-4">
<h4 id="org1ae1115">Function to get the colors palette</h4>
<div class="outline-text-4" id="text-org1ae1115">
<div class="org-src-container">
<pre class="src src-lisp">(<span class="org-keyword">defun</span> <span class="org-function-name">get-color-palette</span> ()
  <span class="org-doc">"Read colors from wal cache file or from `</span><span class="org-doc"><span class="org-constant">default-colors</span></span><span class="org-doc">'."</span>
  (<span class="org-keyword">let</span> ((wal-colors (<span class="org-keyword">when</span> (probe-file wal-colors-path)
                      (uiop:read-file-lines wal-colors-path))))
    (or wal-colors default-colors)))
</pre>
</div>
</div>
</div>
<div id="outline-container-orga074768" class="outline-4">
<h4 id="orga074768">Function to associate names into the colors palette</h4>
<div class="outline-text-4" id="text-orga074768">
<div class="org-src-container">
<pre class="src src-lisp">(<span class="org-keyword">defun</span> <span class="org-function-name">get-color</span> (name)
  <span class="org-doc">"Map the colors from `</span><span class="org-doc"><span class="org-constant">get-color-palette</span></span><span class="org-doc">'."</span>
  (<span class="org-keyword">let</span> ((colors (mapcar 'cons
                        '(<span class="org-string">"color0"</span>
                          <span class="org-string">"color1"</span>
                          <span class="org-string">"color2"</span>
                          <span class="org-string">"color3"</span>
                          <span class="org-string">"color4"</span>
                          <span class="org-string">"color5"</span>
                          <span class="org-string">"color6"</span>
                          <span class="org-string">"color7"</span>
                          <span class="org-string">"color8"</span>
                          <span class="org-string">"color9"</span>
                          <span class="org-string">"color10"</span>
                          <span class="org-string">"color11"</span>
                          <span class="org-string">"color12"</span>
                          <span class="org-string">"color13"</span>
                          <span class="org-string">"color14"</span>
                          <span class="org-string">"color15"</span>)
                        (get-color-palette))))
    (cdr (assoc name colors <span class="org-builtin">:test</span> 'equal))))
</pre>
</div>
</div>
</div>
<div id="outline-container-org2c6669b" class="outline-4">
<h4 id="org2c6669b">Color Variable</h4>
<div class="outline-text-4" id="text-org2c6669b">
<div class="org-src-container">
<pre class="src src-lisp">(setf *background* (get-color <span class="org-string">"color0"</span>))
(setf *foreground* (get-color <span class="org-string">"color7"</span>))
(setf *color0* (get-color <span class="org-string">"color0"</span>))
(setf *color1* (get-color <span class="org-string">"color1"</span>))
(setf *color2* (get-color <span class="org-string">"color2"</span>))
(setf *color3* (get-color <span class="org-string">"color3"</span>))
(setf *color4* (get-color <span class="org-string">"color4"</span>))
(setf *color5* (get-color <span class="org-string">"color5"</span>))
(setf *color6* (get-color <span class="org-string">"color6"</span>))
(setf *color7* (get-color <span class="org-string">"color7"</span>))
(setf *color8* (get-color <span class="org-string">"color8"</span>))
(setf *color9* (get-color <span class="org-string">"color9"</span>))
(setf *color10* (get-color <span class="org-string">"color10"</span>))
(setf *color11* (get-color <span class="org-string">"color11"</span>))
(setf *color12* (get-color <span class="org-string">"color12"</span>))
(setf *color13* (get-color <span class="org-string">"color13"</span>))
(setf *color14* (get-color <span class="org-string">"color14"</span>))
(setf *color15* (get-color <span class="org-string">"color15"</span>))
</pre>
</div>
</div>
</div>
<div id="outline-container-org593a423" class="outline-4">
<h4 id="org593a423">Map the colors into <code>*colors</code> variable</h4>
<div class="outline-text-4" id="text-org593a423">
<div class="org-src-container">
<pre class="src src-lisp">(setq *colors*
      `(,*color0* ,*color1* ,*color2* ,*color3* ,*color4* ,*color5* ,*color6* ,*color7* ,*color8* ,*color9*))
</pre>
</div>
</div>
</div>
<div id="outline-container-org5746d64" class="outline-4">
<h4 id="org5746d64">Update the Color Map</h4>
<div class="outline-text-4" id="text-org5746d64">
<div class="org-src-container">
<pre class="src src-lisp">(update-color-map (current-screen))
</pre>
</div>
</div>
</div>
<div id="outline-container-org22a135e" class="outline-4">
<h4 id="org22a135e">Set the foreground color for the message bar and input</h4>
<div class="outline-text-4" id="text-org22a135e">
<div class="org-src-container">
<pre class="src src-lisp">(set-fg-color *color7*)
</pre>
</div>
</div>
</div>
<div id="outline-container-orgd0740b5" class="outline-4">
<h4 id="orgd0740b5">Set the background color for the message bar and input</h4>
<div class="outline-text-4" id="text-orgd0740b5">
<div class="org-src-container">
<pre class="src src-lisp">(set-bg-color *color0*)
</pre>
</div>
</div>
</div>
<div id="outline-container-orgc30ed50" class="outline-4">
<h4 id="orgc30ed50">Set the border color for the message bar and input</h4>
<div class="outline-text-4" id="text-orgc30ed50">
<div class="org-src-container">
<pre class="src src-lisp">(set-border-color *color2*)
</pre>
</div>
</div>
</div>
<div id="outline-container-org236a15a" class="outline-4">
<h4 id="org236a15a">Set the border color for focused windows.</h4>
<div class="outline-text-4" id="text-org236a15a">
<p>
This is only used when there is more than one frame.
</p>
<div class="org-src-container">
<pre class="src src-lisp">(set-focus-color *color3*)
</pre>
</div>
</div>
</div>
<div id="outline-container-org566f38a" class="outline-4">
<h4 id="org566f38a">Set the border color for windows without focus.</h4>
<div class="outline-text-4" id="text-org566f38a">
<p>
This is only used when there is more than one frame.
</p>
<div class="org-src-container">
<pre class="src src-lisp">(set-unfocus-color *color3*)
</pre>
</div>
</div>
</div>
<div id="outline-container-orgf8b08e5" class="outline-4">
<h4 id="orgf8b08e5">Set the border color for focused windows in a float group</h4>
<div class="outline-text-4" id="text-orgf8b08e5">
<div class="org-src-container">
<pre class="src src-lisp">(set-float-focus-color *color3*)
</pre>
</div>
</div>
</div>
<div id="outline-container-org6a73b04" class="outline-4">
<h4 id="org6a73b04">Set the border color for windows without focus in a float group.</h4>
<div class="outline-text-4" id="text-org6a73b04">
<div class="org-src-container">
<pre class="src src-lisp">(set-float-unfocus-color *color3*)
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-orgeea9ea3" class="outline-3">
<h3 id="orgeea9ea3">Autostarts</h3>
<div class="outline-text-3" id="text-orgeea9ea3">
<p>
The variable <code>*initializing*</code> is only set to <code>T</code> when <i>stumpwm</i> is starting up. Which means once per session. Useful for starting up applications that only needed at startup.
</p>
<div class="org-src-container">
<pre class="src src-lisp">(<span class="org-keyword">when</span> *initializing*
  (<span class="org-keyword">progn</span>
    (run-shell-command <span class="org-string">"xsetroot -cursor_name left_ptr"</span>)
    (run-shell-command <span class="org-string">"nm-applet"</span>)
    (run-shell-command <span class="org-string">"dunst"</span>)
    (run-shell-command <span class="org-string">"picom"</span>)
    (run-shell-command <span class="org-string">"unclutter"</span>)
    (run-shell-command <span class="org-string">"blueman-applet"</span>)
    (run-shell-command <span class="org-string">"xsettingsd"</span>)
    (run-shell-command <span class="org-string">"udiskie -t"</span>)
    (run-shell-command <span class="org-string">"~/.fehbg"</span>)
    (grename <span class="org-string">"Term"</span>) <span class="org-comment">; rename from Default</span>
    (gnewbg <span class="org-string">"Dev"</span>)
    (gnewbg <span class="org-string">"Web"</span>)
    (gnewbg-float <span class="org-string">"Float"</span>) <span class="org-comment">; floating window</span>
    (which-key-mode)))
</pre>
</div>
<p>
This also rename the <i>Default</i> frame to <i>Term</i>. And create additional frame named <i>Dev</i>, and <i>Web</i>. Usually these are all I needed in a session and my muscle memory set them to <i>1</i>, <i>2</i>, and <i>3</i> respectively.
</p>
</div>
</div>
<div id="outline-container-org7622b8d" class="outline-3">
<h3 id="org7622b8d">mode-line helper functions</h3>
<div class="outline-text-3" id="text-org7622b8d">
<ul class="org-ul">
<li><p>
show-battery-charge
</p>
<div class="org-src-container">
<pre class="src src-lisp">(<span class="org-keyword">defun</span> <span class="org-function-name">show-battery-charge</span> ()
  (<span class="org-keyword">cond</span> ((string= <span class="org-string">"freebsd"</span> *os*)
         (<span class="org-keyword">let</span> ((raw-battery
                 (remove
                  #\Newline
                  (run-shell-command <span class="org-string">"apm -l"</span> t))))
           (format nil <span class="org-string">"~D%"</span> raw-battery)))
        ((string= <span class="org-string">"linux"</span> *os*)
         (<span class="org-keyword">let</span> ((raw-battery
                 (run-shell-command
                  <span class="org-string">"acpi | cut -d, -f2"</span> t)))
           (substitute #\Space #\Newline raw-battery)))))
</pre>
</div></li>
<li><p>
show-battery-state
</p>
<div class="org-src-container">
<pre class="src src-lisp">(<span class="org-keyword">defun</span> <span class="org-function-name">show-battery-state</span> ()
  (<span class="org-keyword">cond</span> ((string= <span class="org-string">"freebsd"</span> *os*)
         (<span class="org-keyword">let</span> ((ac-status
                 (remove
                  #\Newline
                  (run-shell-command
                   <span class="org-string">"apm -a"</span> t))))
           (<span class="org-keyword">cond</span> ((equal <span class="org-string">"0"</span> ac-status)
                  (format nil <span class="org-string">"Discharging"</span>))
                 ((equal <span class="org-string">"1"</span> ac-status)
                  (format nil <span class="org-string">"Charging"</span>))
                 ((equal <span class="org-string">"2"</span> ac-status)
                  (format nil <span class="org-string">"Backup Power"</span>)))))
        ((string= <span class="org-string">"linux"</span> *os*)
         (<span class="org-keyword">let</span> ((raw-battery
                 (run-shell-command
                  <span class="org-string">"acpi | cut -d: -f2 | cut -d, -f1"</span> t)))
           (substitute #\Space #\Newline raw-battery)))))
</pre>
</div></li>
<li><p>
show-brightness-value
</p>
<div class="org-src-container">
<pre class="src src-lisp">(<span class="org-keyword">defun</span> <span class="org-function-name">show-brightness-value</span> ()
  (<span class="org-keyword">cond</span> ((string= <span class="org-string">"freebsd"</span> *os*)
         (<span class="org-keyword">let</span> ((current-brightness
                 (remove
                  #\Newline
                  (run-shell-command
                   <span class="org-string">"backlight |sed 's/.*: //'"</span> t))))
           (format nil <span class="org-string">"~A%"</span> current-brightness)))
        ((string= <span class="org-string">"linux"</span> *os*)
         (<span class="org-keyword">let</span> ((max-brightness
                 (parse-integer
                  (run-shell-command
                   <span class="org-string">"brightnessctl max"</span> t)))
               (current-brightness
                 (parse-integer
                  (run-shell-command
                   <span class="org-string">"brightnessctl get"</span> t))))
           (floor (* (/ current-brightness max-brightness) 100))))))
</pre>
</div></li>
<li><p>
show-current-volume
</p>
<div class="org-src-container">
<pre class="src src-lisp">(<span class="org-keyword">defun</span> <span class="org-function-name">show-current-volume</span> ()
  (<span class="org-keyword">let</span> ((current-volume
          (run-shell-command <span class="org-string">"pamixer --get-volume-human"</span> t)))
    (substitute #\Space #\Newline current-volume)))
</pre>
</div></li>
</ul>
</div>
<div id="outline-container-orge307765" class="outline-4">
<h4 id="orge307765">maildir contrib package</h4>
<div class="outline-text-4" id="text-orge307765">
<p>
The <code>maildir:*maildir-alist*</code> already set <i>&ldquo;Mail&rdquo;</i> to <i>&ldquo;~/Mail</i>&ldquo;, which I don&rsquo;t use, so I clear it first before adding my mail directories. Also the path listed must contains the mail directory <code>cur</code>, <code>new</code>, and <code>tmp</code>.
</p>
<div class="org-src-container">
<pre class="src src-lisp">(load-module <span class="org-string">"maildir"</span>)
(setq maildir:*maildir-alist* nil)
(push (cons <span class="org-string">"gmail"</span> (merge-pathnames <span class="org-string">".mail/gmail/inbox/"</span> (user-homedir-pathname)))
      maildir:*maildir-alist*)
(push (cons <span class="org-string">"ymail"</span> (merge-pathnames <span class="org-string">".mail/ymail/inbox/"</span> (user-homedir-pathname)))
      maildir:*maildir-alist*)
(push (cons <span class="org-string">"hotmail"</span> (merge-pathnames <span class="org-string">".mail/hotmail/inbox/"</span> (user-homedir-pathname)))
      maildir:*maildir-alist*)
(push (cons <span class="org-string">"yahoo"</span> (merge-pathnames <span class="org-string">".mail/yahoo/inbox/"</span> (user-homedir-pathname)))
      maildir:*maildir-alist*)
</pre>
</div>
</div>
</div>
<div id="outline-container-org97d1b9c" class="outline-4">
<h4 id="org97d1b9c">MPD contrib package</h4>
<div class="outline-text-4" id="text-org97d1b9c">
<p>
This package also provides mode-line format.
</p>
<div class="org-src-container">
<pre class="src src-lisp">(load-module <span class="org-string">"mpd"</span>)
(mpd:mpd-connect)
</pre>
</div>
<p>
The mode-line format is by default <code>%S [%s;%r;%F]: %a - %A - %t (%n/%p)</code>:
</p>
<dl class="org-dl">
<dt><code>%S</code></dt><dd><code>Playing</code> if playing, <code>Paused</code> if paused, else <code>Stopped</code></dd>
<dt><code>%s</code></dt><dd><code>S</code> if shuffle is on, <code>_</code> otherwise</dd>
<dt><code>%r</code></dt><dd><code>R</code> if repeat is on, <code>_</code> otherwise</dd>
<dt><code>%F</code></dt><dd><code>F=#</code> if crossfade is set, <code>_</code> otherwise</dd>
<dt><code>%a</code></dt><dd>Artist</dd>
<dt><code>%A</code></dt><dd>Album</dd>
<dt><code>%t</code></dt><dd>Title</dd>
</dl>
</div>
<ul class="org-ul">
<li><a id="orge327ca9"></a>Other variables<br>
<div class="outline-text-5" id="text-orge327ca9">
<dl class="org-dl">
<dt><code>*mpd-volume-step*</code></dt><dd><p>
Default to 5
</p>
<div class="org-src-container">
<pre class="src src-lisp">(setf mpd:*mpd-volume-step* 1)
</pre>
</div></dd>
<dt><code>*mpd-socket*</code></dt><dd>Default to <code>#(127 0 0 1)</code></dd>
<dt><code>*mpd-port*</code></dt><dd>Default to 6600</dd>
<dt><code>*mpd-password*</code></dt><dd>Set this if the <i>mpd</i> uses password</dd>
</dl>
</div>
</li>
</ul>
</div>
</div>
<div id="outline-container-orgbdba795" class="outline-3">
<h3 id="orgbdba795">The mode-line variable</h3>
<div class="outline-text-3" id="text-orgbdba795">
<p>
The mode line is a bar that runs across either the top or bottom of a head and is used to display information.  By default the mode line displays the list of windows, similar to the output <code>C-t w</code> produces.
</p>
<div class="org-src-container">
<pre class="src src-lisp">(setf *window-format* <span class="org-string">"%m%t"</span>)
(setf *screen-mode-line-format*
      (list
       <span class="org-string">"[</span><span class="org-string"><span class="org-negation-char">^</span></span><span class="org-string">B^3%n^b] ^4%W"</span>
       <span class="org-string">"^&gt;"</span>
       <span class="org-comment-delimiter">;;</span><span class="org-comment">"%m"</span>
       '(<span class="org-builtin">:eval</span> (format nil <span class="org-string">"^5|Volume: ~D"</span> (show-current-volume)))
       '(<span class="org-builtin">:eval</span> (<span class="org-keyword">when</span> (or (not (empty-directory-p <span class="org-string">"/sys/class/backlight"</span>)) (not (empty-directory-p <span class="org-string">"/dev/backlight"</span>))) (format nil <span class="org-string">"^6|Backlight: ~D%"</span> (show-brightness-value))))
       '(<span class="org-builtin">:eval</span> (<span class="org-keyword">when</span> (or (not (empty-directory-p <span class="org-string">"/sys/class/power_supply"</span>)) (not (eq 255 (parse-integer (remove #\Newline (run-shell-command <span class="org-string">"apm -l"</span> t)))))) (format nil <span class="org-string">"^5|Battery:~D"</span> (show-battery-charge))))
       '(<span class="org-builtin">:eval</span> (<span class="org-keyword">when</span> (or (not (empty-directory-p <span class="org-string">"/sys/class/power_supply"</span>)) (not (eq 255 (parse-integer (remove #\Newline (run-shell-command <span class="org-string">"apm -l"</span> t)))))) (format nil <span class="org-string">" ~D"</span> (show-battery-state))))
       <span class="org-string">"^6|%D"</span> <span class="org-comment">;maildir</span>
       <span class="org-string">"^5|%d"</span>
       ))
(setf *time-modeline-string* <span class="org-string">"%a %b %e %k:%M"</span>)
(setf *mode-line-timeout* 2)
(setf *mode-line-background-color* *background*)
(setf *mode-line-foreground-color* *foreground*)
(setf *mode-line-border-color* *color2*)
(setf *mode-line-border-width* 0)
(enable-mode-line (current-screen) (current-head) t)
</pre>
</div>
<dl class="org-dl">
<dt><code>*window-format*</code></dt><dd>This variable decides how the window list is formatted.  It is a string with the following formatting options:
<dl class="org-dl">
<dt><code>%m</code></dt><dd>Draw a <code>#</code> if the window is marked.</dd>
<dt><code>%n</code></dt><dd>Substitutes the window&rsquo;s number translated via <code>*window-number-map*</code>, if there are more windows than <code>*window-number-map*</code> then will use the window-number.</dd>
<dt><code>%s</code></dt><dd>Substitute the window&rsquo;s status.  <code>*</code> means current window, <code>+</code> means last window, and - means any other window.</dd>
<dt><code>%c</code></dt><dd>Substitute the window&rsquo;s class.</dd>
<dt><code>%t</code></dt><dd>Substitute the window&rsquo;s name.</dd>
<dt><code>%i</code></dt><dd>Substitute the window&rsquo;s resource ID.</dd>
</dl></dd>
<dt><code>*screen-mode-line-format*</code></dt><dd><p>
This variable describes what will be displayed on the modeline for each screen.  Turn it on with the function <code>TOGGLE-MODE-LINE</code> or the <code>mode-line</code> command. It is a list where each element may be a string, a symbol, or a list. For a symbol its value is used. For a list of the form <code>(:eval FORM)</code> <code>FORM</code> is evaluated and the result is used as a mode line element. If it is a string the string is printed with the following formatting options:
</p>
<dl class="org-dl">
<dt><code>%n</code></dt><dd>The current group&rsquo;s name.</dd>
<dt><code>%W</code></dt><dd>List all windows on the current head of the current group using <code>*WINDOW-FORMAT*</code></dd>
<dt><code>%d</code></dt><dd>Using <code>*TIME-MODELINE-STRING*</code>, print the time.</dd>
</dl>
<p>
This variable also uses with the color commands (see <code>info (stumpwm)Colors</code>):
</p>
<dl class="org-dl">
<dt><code>^B</code></dt><dd>Turn on bright colors.</dd>
<dt><code>^b</code></dt><dd>Turn off bright colors.</dd>
<dt>^&lt;digit&gt;</dt><dd>Set the color to <code>&lt;digit&gt;</code> in the <code>*colors</code> variable.</dd>
<dt>%D</dt><dd>This is from the <code>maildir</code> contrib package.</dd>
<dt><code>%m</code></dt><dd>From the <code>mpd</code> contrib package.</dd>
</dl></dd>
<dt><code>*time-modeline-string*</code></dt><dd>The default time value to pass to the modeline. This is using the <i>GNU coreutils</i> format, see <code>info "(coreutils)Date conversion specifiers"</code> for details.</dd>
<dt><code>*mode-line-timeouts*</code></dt><dd>The modeline updates after each command, when a new window appears or an existing one disappears, and on a timer.  This variable controls how many seconds elapse between each update.  If this variable is changed while the modeline is visible, you must toggle the modeline to update timer.</dd>
<dt><code>*mode-line-background-color*</code></dt><dd>The background color for the modeline.</dd>
<dt><code>*mode-line-foreground-color*</code></dt><dd>The foreground color for the modeline.</dd>
<dt><code>*mode-line-border-color*</code></dt><dd>The color of the modeline border.</dd>
<dt><code>*mode-line-border-width*</code></dt><dd>The border width.</dd>
</dl>
<p>
The last line <code>(enable-mode-line (current-screen) (current-head) t)</code> runs the mode-line.
</p>
</div>
</div>
<div id="outline-container-org8a6c81e" class="outline-3">
<h3 id="org8a6c81e">Input and message.</h3>
<div class="outline-text-3" id="text-org8a6c81e">
<dl class="org-dl">
<dt><code>*input-window-gravity*</code></dt><dd><p>
This variable controls where the input window appears. Valid values are: <code>:top-left</code>, <code>:top-right</code>, <code>:bottom-left</code>, <code>:bottom-right</code>, <code>:center</code>, <code>:top</code>, <code>:left</code>, <code>:right</code>, and <code>:bottom</code>.
</p>
<div class="org-src-container">
<pre class="src src-lisp">(setf *input-window-gravity* <span class="org-builtin">:top-right</span>)
</pre>
</div></dd>
<dt><code>*message-window-padding*</code></dt><dd><p>
The number of pixels that pad the text in the message window.
</p>
<div class="org-src-container">
<pre class="src src-lisp">(setf *message-window-padding* 10)
</pre>
</div></dd>
<dt><code>*message-window-y-padding*</code></dt><dd><p>
The number of pixels that pad the text in the message window vertically.
</p>
<div class="org-src-container">
<pre class="src src-lisp">(setf *message-window-y-padding* 10)
</pre>
</div></dd>
<dt><b>message-window-gravity</b></dt><dd><p>
This variable controls where the message window appears. Valid values are: <code>:top-left</code>, <code>:top-right</code>, <code>:bottom-left</code>, <code>:bottom-right</code>, <code>:center</code>, <code>:top</code>, <code>:left</code>, <code>:right</code>, and <code>:bottom</code>.
</p>
<div class="org-src-container">
<pre class="src src-lisp">(setf *message-window-gravity* <span class="org-builtin">:top-right</span>)
</pre>
</div></dd>
<dt><code>*message-window-input-gravity*</code></dt><dd><p>
This variable controls where the message window appears when the input window is being displayed. Valid values are: <code>:top-left</code>, <code>:top-right</code>, <code>:bottom-left</code>, <code>:bottom-right</code>, <code>:center</code>, <code>:top</code>, <code>:left</code>, <code>:right</code>, and <code>:bottom</code>.
</p>
<div class="org-src-container">
<pre class="src src-lisp">(setf *message-window-input-gravity* <span class="org-builtin">:top-left</span>)
</pre>
</div></dd>
<dt>set-msg-border-width</dt><dd><p>
Set the border width for the message bar, input bar and frame indicator.
</p>
<div class="org-src-container">
<pre class="src src-lisp">(set-msg-border-width 0)
</pre>
</div></dd>
</dl>
</div>
</div>

<div id="outline-container-org2d9b4ed" class="outline-3">
<h3 id="org2d9b4ed">Window Appearance</h3>
<div class="outline-text-3" id="text-org2d9b4ed">
<dl class="org-dl">
<dt><code>*maxsize-border-width*</code></dt><dd><p>
The width in pixels given to the borders of windows with maxsize or ratio hints.
</p>
<div class="org-src-container">
<pre class="src src-lisp">(setf *maxsize-border-width* 0)
</pre>
</div></dd>
<dt><code>*transient-border-width*</code></dt><dd><p>
The width in pixels given to the borders of transient or pop-up windows.
</p>
<div class="org-src-container">
<pre class="src src-lisp">(setf *transient-border-width* 0)
</pre>
</div></dd>
<dt><code>*window-border-style*</code></dt><dd><p>
This controls the appearance of the border around windows. Valid values are: <code>:thick</code>, <code>:thin</code>, <code>:tight</code>, and <code>:none</code>.
</p>
<div class="org-src-container">
<pre class="src src-lisp">(setf *window-border-style* <span class="org-builtin">:none</span>)
</pre>
</div></dd>
</dl>
</div>
</div>
<div id="outline-container-org7a4e534" class="outline-3">
<h3 id="org7a4e534">Font</h3>
<div class="outline-text-3" id="text-org7a4e534">
<p>
In order to use <i>TTF</i> fonts, we need an additional package <code>ttf-fonts</code>, which is available in the <code>contrib</code> repository, or from <i>quicklisp</i>.
</p>
<div class="org-src-container">
<pre class="src src-lisp">(ql:quickload <span class="org-builtin">:ttf-fonts</span>)
</pre>
</div>
<p>
This package also depends on <a href="https://www.google.com.hk/search?client=firefox-b-d&amp;q=github+clx-truetype&amp;pli=1">clx-truetype</a> which sadly is not in <i>quicklisp</i> repository, add it manually to the <code>local-projects</code> directory inside your <i>quicklisp</i> installation directory (when not set usually in <code>~/quicklisp</code>)
</p>
</div>
<div id="outline-container-orgae250ae" class="outline-4">
<h4 id="orgae250ae"><code>*font-dir*</code></h4>
<div class="outline-text-4" id="text-orgae250ae">
<p>
This is empty by default, so populate it first
</p>
<div class="org-src-container">
<pre class="src src-lisp">(setf xft:*font-dirs* `(<span class="org-string">"/usr/share/fonts/"</span>
                        <span class="org-string">"/usr/local/share/fonts"</span>
                        ,(merge-pathnames <span class="org-string">".local/share/fonts"</span>
                                          (user-homedir-pathname))))
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org65e899f" class="outline-3">
<h3 id="org65e899f">The Keybindings</h3>
<div class="outline-text-3" id="text-org65e899f">
<p>
There are several variables that defines when a <i>keybinding</i> is used:
</p>
<dl class="org-dl">
<dt><code>*root-map*</code></dt><dd>Known as the &ldquo;<i>prefix-map</i>&rdquo;.</dd>
<dt><code>*top-map*</code></dt><dd>This is where you&rsquo;ll find the bindings for the &ldquo;<i>prefix-map</i>&rdquo;.</dd>
<dt><code>*group-map*</code></dt><dd>The keymap that group related key bindings sit on.</dd>
<dt><code>*group-top-map*</code></dt><dd>An alist of the top level maps for each group type.</dd>
<dt><code>*exchange-window-map*</code></dt><dd>The keymap that <code>exchange-window</code> key bindings sit on.</dd>
</dl>
</div>
<div id="outline-container-org7e656e5" class="outline-4">
<h4 id="org7e656e5">Sets the prefix</h4>
<div class="outline-text-4" id="text-org7e656e5">
<p>
Here I&rsquo;m using <code>s-SPC</code> (<i>Super Key</i> and the spacebar).
</p>
<div class="org-src-container">
<pre class="src src-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">change the prefix key to something else</span>
(set-prefix-key (kbd <span class="org-string">"s-SPC"</span>))
</pre>
</div>
<p>
The <code>kbd</code> itself is a function specific to <i>stumpwm</i>.
</p>
</div>
</div>
<div id="outline-container-org727554a" class="outline-4">
<h4 id="org727554a">Sparse Keymaps</h4>
<div class="outline-text-4" id="text-org727554a">
<p>
The function <code>make-sparse-keymap</code> used to create a new list of bindings in the key binding tree.
</p>
</div>
<ul class="org-ul">
<li><a id="org21bff82"></a><span class="todo TODO">TODO</span> screenshot<br>
<div class="outline-text-5" id="text-org21bff82">
<ul class="org-ul">
<li>State &ldquo;TODO&rdquo;       from              <span class="timestamp-wrapper"><span class="timestamp">[2022-04-10 Sun 03:26]</span></span></li>
</ul>
<p>
For now I&rsquo;ll use <i>flameshot</i>. But eventually I&rsquo;ll use either the contrib module or using my own script.
</p>
<div class="org-src-container">
<pre class="src src-lisp">(<span class="org-keyword">defvar</span> <span class="org-variable-name">*my-screenshot-keymap*</span>
  (<span class="org-keyword">let</span> ((m (make-sparse-keymap)))
    (define-key m (kbd <span class="org-string">"d"</span>) <span class="org-string">"exec flameshot gui -d 3000"</span>)
    (define-key m (kbd <span class="org-string">"s"</span>) <span class="org-string">"exec flameshot full"</span>)
    (define-key m (kbd <span class="org-string">"S"</span>) <span class="org-string">"exec flameshot gui"</span>)
    m))
</pre>
</div>
</div>
</li>
<li><a id="orgb44bc7a"></a>End-session<br>
<div class="outline-text-5" id="text-orgb44bc7a">
<p>
This uses the <code>end-session</code> <i>contrib</i> module.
</p>
<div class="org-src-container">
<pre class="src src-lisp">(load-module <span class="org-string">"end-session"</span>)
(<span class="org-keyword">defvar</span> <span class="org-variable-name">*my-end-session-keymap*</span>
  (<span class="org-keyword">let</span> ((m (make-sparse-keymap)))
    (define-key m (kbd <span class="org-string">"q"</span>) <span class="org-string">"end-session"</span>)
    (define-key m (kbd <span class="org-string">"l"</span>) <span class="org-string">"logout"</span>)
    (define-key m (kbd <span class="org-string">"s"</span>) <span class="org-string">"suspend-computer"</span>)
    (define-key m (kbd <span class="org-string">"S"</span>) <span class="org-string">"shutdown-computer"</span>)
    (define-key m (kbd <span class="org-string">"r"</span>) <span class="org-string">"loadrc"</span>)
    (define-key m (kbd <span class="org-string">"R"</span>) <span class="org-string">"restart-hard"</span>)
    (define-key m (kbd <span class="org-string">"s-r"</span>) <span class="org-string">"restart-computer"</span>)
    m))
</pre>
</div>
<p>
And bind it to <code>C-s-q</code> (that <code>Control</code>, <code>Shift</code>, and <code>q</code>).
</p>
<div class="org-src-container">
<pre class="src src-lisp">(define-key *top-map* (kbd <span class="org-string">"C-s-q"</span>) '*my-end-session-keymap*)
</pre>
</div>
</div>
</li>
<li><a id="org1e63bdb"></a>Describe function<br>
<div class="outline-text-5" id="text-org1e63bdb">
<div class="org-src-container">
<pre class="src src-lisp">(<span class="org-keyword">defvar</span> <span class="org-variable-name">*my-describe-bindings*</span>
  (<span class="org-keyword">let</span> ((m (make-sparse-keymap)))
    (define-key m (kbd <span class="org-string">"v"</span>) <span class="org-string">"describe-variable"</span>)
    (define-key m (kbd <span class="org-string">"f"</span>) <span class="org-string">"describe-function"</span>)
    (define-key m (kbd <span class="org-string">"c"</span>) <span class="org-string">"describe-command"</span>)
    (define-key m (kbd <span class="org-string">"k"</span>) <span class="org-string">"describe-key"</span>)
    m))
</pre>
</div>
</div>
</li>
<li><a id="orgb93ef76"></a>float keymap<br>
<div class="outline-text-5" id="text-orgb93ef76">
<div class="org-src-container">
<pre class="src src-lisp">(<span class="org-keyword">defvar</span> <span class="org-variable-name">*my-frames-float-keymap*</span>
  (<span class="org-keyword">let</span> ((m (make-sparse-keymap)))
    (define-key m (kbd <span class="org-string">"f"</span>) <span class="org-string">"float-this"</span>)
    (define-key m (kbd <span class="org-string">"F"</span>) <span class="org-string">"unfloat-this"</span>)
    (define-key m (kbd <span class="org-string">"u"</span>) <span class="org-string">"unfloat-this"</span>)
    (define-key m (kbd <span class="org-string">"s-f"</span>) <span class="org-string">"flatten-floats"</span>)
    m))
</pre>
</div>
</div>
</li>
<li><a id="org21c651c"></a>frame management<br>
<div class="outline-text-5" id="text-org21c651c">
<div class="org-src-container">
<pre class="src src-lisp">(<span class="org-keyword">defvar</span> <span class="org-variable-name">*my-frames-management-keymap*</span>
  (<span class="org-keyword">let</span> ((m (make-sparse-keymap)))
    (define-key m (kbd <span class="org-string">"C-b"</span>) <span class="org-string">"move-focus left"</span>)
    (define-key m (kbd <span class="org-string">"C-n"</span>) <span class="org-string">"move-focus down"</span>)
    (define-key m (kbd <span class="org-string">"C-p"</span>) <span class="org-string">"move-focus up"</span>)
    (define-key m (kbd <span class="org-string">"C-f"</span>) <span class="org-string">"move-focus right"</span>)
    (define-key m (kbd <span class="org-string">"C-B"</span>) <span class="org-string">"move-window left"</span>)
    (define-key m (kbd <span class="org-string">"C-N"</span>) <span class="org-string">"move-window down"</span>)
    (define-key m (kbd <span class="org-string">"C-P"</span>) <span class="org-string">"move-window up"</span>)
    (define-key m (kbd <span class="org-string">"C-F"</span>) <span class="org-string">"move-window right"</span>)
    (define-key m (kbd <span class="org-string">"M-b"</span>) <span class="org-string">"exchange-direction left"</span>)
    (define-key m (kbd <span class="org-string">"M-n"</span>) <span class="org-string">"exchange-direction down"</span>)
    (define-key m (kbd <span class="org-string">"M-p"</span>) <span class="org-string">"exchange-direction up"</span>)
    (define-key m (kbd <span class="org-string">"M-f"</span>) <span class="org-string">"exchange-direction right"</span>)
    (define-key m (kbd <span class="org-string">"/"</span>) <span class="org-string">"hsplit-and-focus"</span>)
    (define-key m (kbd <span class="org-string">"-"</span>) <span class="org-string">"vsplit-and-focus"</span>)
    (define-key m (kbd <span class="org-string">"h"</span>) <span class="org-string">"hsplit"</span>)
    (define-key m (kbd <span class="org-string">"v"</span>) <span class="org-string">"vsplit"</span>)
    (define-key m (kbd <span class="org-string">"H"</span>) <span class="org-string">"hsplit-equally"</span>)
    (define-key m (kbd <span class="org-string">"V"</span>) <span class="org-string">"vsplit-equally"</span>)
    (define-key m (kbd <span class="org-string">"."</span>) <span class="org-string">"iresize"</span>)
    (define-key m (kbd <span class="org-string">"+"</span>) <span class="org-string">"balance-frames"</span>)
    (define-key m (kbd <span class="org-string">"d"</span>) <span class="org-string">"remove-split"</span>)
    (define-key m (kbd <span class="org-string">"D"</span>) <span class="org-string">"only"</span>)
    (define-key m (kbd <span class="org-string">"e"</span>) <span class="org-string">"expose"</span>)
    (define-key m (kbd <span class="org-string">"f"</span>) <span class="org-string">"fullscreen"</span>)
    (define-key m (kbd <span class="org-string">"s-w"</span>) '*my-frames-float-keymap*)
    (define-key m (kbd <span class="org-string">"i"</span>) <span class="org-string">"info"</span>)
    (define-key m (kbd <span class="org-string">"I"</span>) <span class="org-string">"show-window-properties"</span>)
    (define-key m (kbd <span class="org-string">"m"</span>) <span class="org-string">"meta"</span>)
    (define-key m (kbd <span class="org-string">"s"</span>) <span class="org-string">"sibling"</span>)
    (define-key m (kbd <span class="org-string">"u"</span>) <span class="org-string">"next-urgent"</span>)
    (define-key m (kbd <span class="org-string">"U"</span>) <span class="org-string">"unmaximize"</span>)
    (define-key m (kbd <span class="org-string">"k"</span>) <span class="org-string">"delete-window"</span>)
    (define-key m (kbd <span class="org-string">"b"</span>) <span class="org-string">"windowlist-by-class"</span>)
    (define-key m (kbd <span class="org-string">"DEL"</span>) <span class="org-string">"repack-window-numbers"</span>)
    (define-key m (kbd <span class="org-string">"RET"</span>) <span class="org-string">"expose"</span>)
    m))
</pre>
</div>
</div>
</li>
<li><a id="org4f0d6f1"></a>apps<br>
<div class="outline-text-5" id="text-org4f0d6f1">
<div class="org-src-container">
<pre class="src src-lisp">(<span class="org-keyword">defvar</span> <span class="org-variable-name">*my-app-bindings*</span>
  (<span class="org-keyword">let</span> ((m (make-sparse-keymap)))
    (define-key m (kbd <span class="org-string">"e"</span>) <span class="org-string">"emacs"</span>)
    (define-key m (kbd <span class="org-string">"w"</span>) <span class="org-string">"web"</span>)
    (define-key m (kbd <span class="org-string">"s-w"</span>) <span class="org-string">"exec $TERMINAL -e nmtui"</span>)
    (define-key m (kbd <span class="org-string">"g"</span>) <span class="org-string">"exec gimp"</span>)
    (define-key m (kbd <span class="org-string">"f"</span>) <span class="org-string">"exec thunar"</span>)
    (define-key m (kbd <span class="org-string">"s-p"</span>) <span class="org-string">"exec rofi-pass"</span>)
    (define-key m (kbd <span class="org-string">"p"</span>) <span class="org-string">"exec picard"</span>)
    (define-key m (kbd <span class="org-string">"h"</span>) <span class="org-string">"exec hakuneko-desktop"</span>)
    (define-key m (kbd <span class="org-string">"v"</span>) <span class="org-string">"exec vlc"</span>)
    (define-key m (kbd <span class="org-string">"S"</span>) <span class="org-string">"exec *my-screenshot-keymap*"</span>)
    (define-key m (kbd <span class="org-string">"t"</span>) <span class="org-string">"exec emacsclient -c -e \"(telega)\""</span>)
    (define-key m (kbd <span class="org-string">"T"</span>) <span class="org-string">"exec telegram-desktop"</span>)
    m))
</pre>
</div>
</div>
</li>
</ul>
</div>
<div id="outline-container-org68a4f03" class="outline-4">
<h4 id="org68a4f03"><span class="todo TODO">TODO</span> Undefine default keybindings</h4>
<div class="outline-text-4" id="text-org68a4f03">
<ul class="org-ul">
<li>State &ldquo;TODO&rdquo;       from              <span class="timestamp-wrapper"><span class="timestamp">[2022-04-10 Sun 03:22]</span></span></li>
</ul>
</div>
</div>
<div id="outline-container-org91a1e63" class="outline-4">
<h4 id="org91a1e63">Custom functions, commands and macros</h4>
<div class="outline-text-4" id="text-org91a1e63">
</div>
<ul class="org-ul">
<li><a id="orga41d975"></a>colon1<br>
<div class="outline-text-5" id="text-orga41d975">
<p>
This is a custom command from the default configuration that prompt the user for an interactive command. The first arg is an optional initial contents.
</p>
<div class="org-src-container">
<pre class="src src-lisp">(defcommand colon1 (<span class="org-type">&amp;optional</span> (initial <span class="org-string">""</span>)) (<span class="org-builtin">:rest</span>)
  (<span class="org-keyword">let</span> ((cmd (read-one-line (current-screen) <span class="org-string">": "</span> <span class="org-builtin">:initial-input</span> initial)))
    (<span class="org-keyword">when</span> cmd
      (eval-command cmd t))))
</pre>
</div>
<p>
Note that in <i>stumpwm</i> there&rsquo;s also the <i>command</i> <code>colon</code> by default.
</p>
</div>
</li>
<li><a id="org9975efb"></a>make-web-jump<br>
<div class="outline-text-5" id="text-org9975efb">
<p>
Also from the default configuration, currently sets for <i>DuckDuckGo</i> and <i>IMDB</i>.
</p>
<div class="org-src-container">
<pre class="src src-lisp">(<span class="org-keyword">defmacro</span> <span class="org-function-name">make-web-jump</span> (name prefix)
  `(defcommand ,(intern name) (search) ((<span class="org-builtin">:rest</span> ,(concatenate 'string name <span class="org-string">" search: "</span>)))
     (nsubstitute #\+ #\Space search)
     (run-shell-command (concatenate 'string ,prefix search))))

(make-web-jump <span class="org-string">"duckduckgo"</span> <span class="org-string">"firefox https://duckduckgo.com/?q="</span>)
(make-web-jump <span class="org-string">"imdb"</span> <span class="org-string">"firefox http://www.imdb.com/find?q="</span>)
</pre>
</div>
</div>
</li>
<li><a id="org79c2248"></a>Split window<br>
<div class="outline-text-5" id="text-org79c2248">
<div class="org-src-container">
<pre class="src src-lisp">(defcommand hsplit-and-focus () ()
  <span class="org-string">"Create a new frame on the right and focus it."</span>
  (hsplit)
  (move-focus <span class="org-builtin">:right</span>))

(defcommand vsplit-and-focus () ()
  <span class="org-string">"Create a new frame below and move focus to it."</span>
  (vsplit)
  (move-focus <span class="org-builtin">:down</span>))
</pre>
</div>
</div>
</li>
<li><a id="orgb890c44"></a>emacs<br>
<div class="outline-text-5" id="text-orgb890c44">
<p>
Will start <i>Emacs</i> when there&rsquo;s no server with the name <code>*emacs-daemon-name*</code>, else will start daemonized <i>Emacs</i>.
</p>
<div class="org-src-container">
<pre class="src src-lisp">(defcommand emacs () ()
  <span class="org-string">"Run or raise Emacs."</span>
  (<span class="org-keyword">let</span> ((cmd
          (<span class="org-keyword">if</span> *chemacs-profile*
              (format nil <span class="org-string">"emacsclient -s ~A -c -a emacs"</span> *emacs-daemon-name*)
              (format nil <span class="org-string">"emacsclient -c -a emacs"</span>))))
    (run-shell-command cmd)))
</pre>
</div>
</div>
</li>
<li><a id="org61cef3f"></a>Browser<br>
<div class="outline-text-5" id="text-org61cef3f">
<p>
Use the environment variable <code>${BROWSER}</code> if set.
</p>
<div class="org-src-container">
<pre class="src src-lisp">(<span class="org-keyword">let</span> ((browser (or (getenv <span class="org-string">"BROWSER"</span>)
                   <span class="org-string">"firefox"</span>)))
  (setf *web-browser* browser))

(defcommand web () ()
  <span class="org-string">"Run or raise browser."</span>
  (run-or-raise *web-browser* `(<span class="org-builtin">:class</span> ,*web-browser*) t nil))
</pre>
</div>
</div>
</li>
<li><a id="org46778cc"></a>Terminal Emulator<br>
<div class="outline-text-5" id="text-org46778cc">
<p>
Although <i>XTerm</i> is my default terminal-emulator, I sometimes try tinkering with other programs, so I set the <code>$TERMINAL</code> environment variable to set my current terminal-emulator.
</p>
<div class="org-src-container">
<pre class="src src-lisp">(<span class="org-keyword">let</span> ((terminal (or (getenv <span class="org-string">"TERMINAL"</span>)
                    <span class="org-string">"xterm"</span>)))
  (setf *terminal-emulator* terminal))

(defcommand terminal () ()
  (run-or-raise *terminal-emulator* `(<span class="org-builtin">:class</span> ,*terminal-emulator*)))
</pre>
</div>
<p>
And my default keybinding is <code>s-RET</code>.
</p>
<div class="org-src-container">
<pre class="src src-lisp">(define-key *top-map* (kbd <span class="org-string">"s-RET"</span>) <span class="org-string">"terminal"</span>)
</pre>
</div>
</div>
</li>
</ul>
</div>
<div id="outline-container-org456d164" class="outline-4">
<h4 id="org456d164">Keybinding Tree</h4>
<div class="outline-text-4" id="text-org456d164">
<p>
This is what in <i>Emacs</i> called &ldquo;keychord&rdquo; (I think). So, <code>s-h v</code> is for the function <code>describe-variable</code> and so on. Also note that since I&rsquo;m already use <code>s-d h</code> this means I&rsquo;m not using the usual <i>window-manager</i> <i>vim</i> keybindings (<code>h</code>, <code>j</code>, <code>k</code>, <code>l</code>). Also since &ldquo;<code>h</code>&rdquo; is actually already bound in <code>*top-map*</code> I need to unbind it in order to set it for <code>*my-describe-bindings*</code>.
</p>
</div>
<ul class="org-ul">
<li><a id="org0cc1b10"></a>Top Map<br>
<div class="outline-text-5" id="text-org0cc1b10">
<p>
This is the keybinding that resides on the <code>*top-map*</code>
</p>
</div>
<ul class="org-ul">
<li><a id="org272978e"></a><code>*my-describe-bindings*</code><br>
<div class="outline-text-6" id="text-org272978e">
<div class="org-src-container">
<pre class="src src-lisp">(define-key *top-map* (kbd <span class="org-string">"s-h"</span>) '*my-describe-bindings*)
</pre>
</div>
</div>
</li>
<li><a id="org92e7ba4"></a>Media Keys<br>
<ul class="org-ul">
<li><a id="org6b112e4"></a>Volume<br>
<div class="outline-text-7" id="text-org6b112e4">
<p>
Using <i>PulseAudio</i>.
</p>
<div class="org-src-container">
<pre class="src src-lisp">(define-key *top-map* (kbd <span class="org-string">"XF86AudioLowerVolume"</span>) <span class="org-string">"exec pactl -- set-sink-volume @DEFAULT_SINK@ -2%"</span>)
(define-key *top-map* (kbd <span class="org-string">"XF86AudioRaiseVolume"</span>) <span class="org-string">"exec pactl -- set-sink-volume @DEFAULT_SINK@ +2%"</span>)
(define-key *top-map* (kbd <span class="org-string">"XF86AudioMute"</span>) <span class="org-string">"exec pactl -- set-sink-mute @DEFAULT_SINK@ toggle"</span>)
</pre>
</div>
</div>
</li>
<li><a id="org477b94d"></a>Audio Player<br>
<div class="outline-text-7" id="text-org477b94d">
<div class="org-src-container">
<pre class="src src-lisp">(define-key *top-map* (kbd <span class="org-string">"XF86AudioPlay"</span>) <span class="org-string">"exec playerctl play-pause"</span>)
(define-key *top-map* (kbd <span class="org-string">"XF86AudioNext"</span>) <span class="org-string">"exec playerctl next"</span>)
(define-key *top-map* (kbd <span class="org-string">"XF86AudioPrev"</span>) <span class="org-string">"exec playerctl previous"</span>)
</pre>
</div>
</div>
</li>
<li><a id="org9fb92d1"></a>Backlight<br>
<div class="outline-text-7" id="text-org9fb92d1">
<div class="org-src-container">
<pre class="src src-lisp">(define-key *top-map* (kbd <span class="org-string">"XF86MonBrightnessDown"</span>) <span class="org-string">"exec brightnessctl set 1%-"</span>)
(define-key *top-map* (kbd <span class="org-string">"XF86MonBrightnessUp"</span>) <span class="org-string">"exec brightnessctl set +1%"</span>)
</pre>
</div>
</div>
</li>
</ul>
</li>
<li><a id="org33327e8"></a>Picom transparency<br>
<div class="outline-text-6" id="text-org33327e8">
<div class="org-src-container">
<pre class="src src-lisp">(define-key *top-map* (kbd <span class="org-string">"s-F2"</span>) <span class="org-string">"exec picom-trans -c -5"</span>)
(define-key *top-map* (kbd <span class="org-string">"s-F3"</span>) <span class="org-string">"exec picom-trans -c +5"</span>)
</pre>
</div>
</div>
</li>
<li><a id="orge0ab05e"></a>rofi<br>
<div class="outline-text-6" id="text-orge0ab05e">
<div class="org-src-container">
<pre class="src src-lisp">(define-key *top-map* (kbd <span class="org-string">"s-d"</span>) <span class="org-string">"exec rofi -show drun"</span>)
</pre>
</div>
</div>
</li>
<li><a id="orgfffb413"></a><code>colon</code><br>
<div class="outline-text-6" id="text-orgfffb413">
<p>
I use this often enough it deserve it&rsquo;s own key.
</p>
<div class="org-src-container">
<pre class="src src-lisp">(define-key *top-map* (kbd <span class="org-string">"s-M-x"</span>) <span class="org-string">"colon"</span>)
</pre>
</div>
</div>
</li>
<li><a id="orgfef3d1e"></a>Mail<br>
<div class="outline-text-6" id="text-orgfef3d1e">
<p>
Bind it to <code>XF86Mail</code>
</p>
<div class="org-src-container">
<pre class="src src-lisp">(define-key *top-map* (kbd <span class="org-string">"XF86Mail"</span>) <span class="org-string">"exec emacsclient -c -e \"(notmuch)\""</span>)
</pre>
</div>
</div>
</li>
<li><a id="orgeff500b"></a>Web<br>
<div class="outline-text-6" id="text-orgeff500b">
<p>
Bound to <code>XF86MyComputer</code>
</p>
<div class="org-src-container">
<pre class="src src-lisp">(define-key *top-map* (kbd <span class="org-string">"XF86MyComputer"</span>) <span class="org-string">"web"</span>)
</pre>
</div>
</div>
</li>
<li><a id="org116848d"></a>Group selections<br>
<div class="outline-text-6" id="text-org116848d">
<div class="org-src-container">
<pre class="src src-lisp">(define-key *top-map* (kbd <span class="org-string">"s-1"</span>) <span class="org-string">"gselect 1"</span>)
(define-key *top-map* (kbd <span class="org-string">"s-2"</span>) <span class="org-string">"gselect 2"</span>)
(define-key *top-map* (kbd <span class="org-string">"s-3"</span>) <span class="org-string">"gselect 3"</span>)
(define-key *top-map* (kbd <span class="org-string">"s-4"</span>) <span class="org-string">"gselect 4"</span>)
(define-key *top-map* (kbd <span class="org-string">"s-5"</span>) <span class="org-string">"gselect 5"</span>)
(define-key *top-map* (kbd <span class="org-string">"s-6"</span>) <span class="org-string">"gselect 6"</span>)
(define-key *top-map* (kbd <span class="org-string">"s-7"</span>) <span class="org-string">"gselect 7"</span>)
(define-key *top-map* (kbd <span class="org-string">"s-8"</span>) <span class="org-string">"gselect 8"</span>)
(define-key *top-map* (kbd <span class="org-string">"s-9"</span>) <span class="org-string">"gselect 9"</span>)
(define-key *top-map* (kbd <span class="org-string">"s-0"</span>) <span class="org-string">"gselect 10"</span>)

(define-key *top-map* (kbd <span class="org-string">"s-TAB"</span>) <span class="org-string">"gother"</span>)
</pre>
</div>
</div>
</li>
<li><a id="org3ff46e4"></a>Group move<br>
<div class="outline-text-6" id="text-org3ff46e4">
<div class="org-src-container">
<pre class="src src-lisp">(define-key *top-map* (kbd <span class="org-string">"s-!"</span>) <span class="org-string">"gmove-and-follow 1"</span>)
(define-key *top-map* (kbd <span class="org-string">"s-@"</span>) <span class="org-string">"gmove-and-follow 2"</span>)
(define-key *top-map* (kbd <span class="org-string">"s-#"</span>) <span class="org-string">"gmove-and-follow 3"</span>)
(define-key *top-map* (kbd <span class="org-string">"s-$"</span>) <span class="org-string">"gmove-and-follow 4"</span>)
(define-key *top-map* (kbd <span class="org-string">"s-%"</span>) <span class="org-string">"gmove-and-follow 5"</span>)
(define-key *top-map* (kbd <span class="org-string">"s-^"</span>) <span class="org-string">"gmove-and-follow 6"</span>)
(define-key *top-map* (kbd <span class="org-string">"s-&amp;"</span>) <span class="org-string">"gmove-and-follow 7"</span>)
(define-key *top-map* (kbd <span class="org-string">"s-*"</span>) <span class="org-string">"gmove-and-follow 8"</span>)
(define-key *top-map* (kbd <span class="org-string">"s-("</span>) <span class="org-string">"gmove-and-follow 9"</span>)
(define-key *top-map* (kbd <span class="org-string">"s-)"</span>) <span class="org-string">"gmove-and-follow 10"</span>)
</pre>
</div>
</div>
</li>
<li><a id="org49aafd2"></a>Binding for <code>*my-frame-management-keymap*</code><br>
<div class="outline-text-6" id="text-org49aafd2">
<div class="org-src-container">
<pre class="src src-lisp">(define-key *top-map* (kbd <span class="org-string">"s-w"</span>) '*my-frames-management-keymap*)
</pre>
</div>
</div>
</li>
<li><a id="org7f219a3"></a>Binding for <code>*my-app-bindings</code><br>
<div class="outline-text-6" id="text-org7f219a3">
<div class="org-src-container">
<pre class="src src-lisp">(define-key *top-map* (kbd <span class="org-string">"s-x"</span>) '*my-app-bindings*)
</pre>
</div>
</div>
</li>
<li><a id="org6ec0274"></a>escape-key<br>
<div class="outline-text-6" id="text-org6ec0274">
<div class="org-src-container">
<pre class="src src-lisp">(define-key *top-map* (kbd <span class="org-string">"s-quoteleft"</span>) <span class="org-string">"send-raw-key"</span>)
</pre>
</div>
</div>
</li>
<li><a id="org1c7622c"></a>Screenshot<br>
<div class="outline-text-6" id="text-org1c7622c">
<p>
Most keyboard have the <code>Print</code> key, so I&rsquo;ll bind it there
</p>
<div class="org-src-container">
<pre class="src src-lisp">(define-key *top-map* (kbd <span class="org-string">"Print"</span>) '*my-screenshot-keymap*)
</pre>
</div>
</div>
</li>
<li><a id="org8eea0f7"></a>Frame movement<br>
<div class="outline-text-6" id="text-org8eea0f7">
<p>
Using <i>Emacs</i> keys
</p>
<div class="org-src-container">
<pre class="src src-lisp">(define-key *top-map* (kbd <span class="org-string">"s-p"</span>) <span class="org-string">"move-focus up"</span>)
(define-key *top-map* (kbd <span class="org-string">"s-n"</span>) <span class="org-string">"move-focus down"</span>)
(define-key *top-map* (kbd <span class="org-string">"s-f"</span>) <span class="org-string">"move-focus right"</span>)
(define-key *top-map* (kbd <span class="org-string">"s-b"</span>) <span class="org-string">"move-focus left"</span>)
</pre>
</div>
<p>
Using numbers
</p>
<div class="org-src-container">
<pre class="src src-lisp">(define-key *top-map* (kbd <span class="org-string">"s-M-0"</span>) <span class="org-string">"pull 0"</span>)
(define-key *top-map* (kbd <span class="org-string">"s-M-1"</span>) <span class="org-string">"pull 1"</span>)
(define-key *top-map* (kbd <span class="org-string">"s-M-2"</span>) <span class="org-string">"pull 2"</span>)
(define-key *top-map* (kbd <span class="org-string">"s-M-3"</span>) <span class="org-string">"pull 3"</span>)
(define-key *top-map* (kbd <span class="org-string">"s-M-4"</span>) <span class="org-string">"pull 4"</span>)
(define-key *top-map* (kbd <span class="org-string">"s-M-5"</span>) <span class="org-string">"pull 5"</span>)
(define-key *top-map* (kbd <span class="org-string">"s-M-6"</span>) <span class="org-string">"pull 6"</span>)
(define-key *top-map* (kbd <span class="org-string">"s-M-7"</span>) <span class="org-string">"pull 7"</span>)
(define-key *top-map* (kbd <span class="org-string">"s-M-8"</span>) <span class="org-string">"pull 8"</span>)
(define-key *top-map* (kbd <span class="org-string">"s-M-9"</span>) <span class="org-string">"pull 9"</span>)
</pre>
</div>
</div>
</li>
</ul>
</li>
<li><a id="org73c720c"></a>Group Map<br>
<ul class="org-ul">
<li><a id="org9e1177a"></a>vgroups<br>
<div class="outline-text-6" id="text-org9e1177a">
<div class="org-src-container">
<pre class="src src-lisp">(define-key *groups-map* (kbd <span class="org-string">"G"</span>) <span class="org-string">"vgroups"</span>)
</pre>
</div>
</div>
</li>
</ul>
</li>
<li><a id="orgc471a4d"></a>Root Map<br>
<ul class="org-ul">
<li><a id="org683b709"></a>Binding for <code>*group-map*</code><br>
<div class="outline-text-6" id="text-org683b709">
<p>
This is already set by default.
</p>
<div class="org-src-container">
<pre class="src src-lisp">(define-key *root-map* (kbd <span class="org-string">"g"</span>) '*groups-map*)
</pre>
</div>
</div>
</li>
<li><a id="org480653a"></a>Slynk<br>
<div class="outline-text-6" id="text-org480653a">
<div class="org-src-container">
<pre class="src src-lisp">(define-key *root-map* (kbd <span class="org-string">"s-s"</span>) <span class="org-string">"slynk"</span>)
</pre>
</div>
</div>
</li>
</ul>
</li>
</ul>
</div>
<div id="outline-container-orgb6d7253" class="outline-4">
<h4 id="orgb6d7253">Function key</h4>
<div class="outline-text-4" id="text-orgb6d7253">
<p>
This keymap is for keyboard with no media keys. On my laptop the media key is mapped to the Function keys:
</p>
<table>


<colgroup>
<col  class="org-left">

<col  class="org-left">

<col  class="org-left">
</colgroup>
<tbody>
<tr>
<td class="org-left">Function Key</td>
<td class="org-left">Media Key</td>
<td class="org-left">Note</td>
</tr>

<tr>
<td class="org-left">F1</td>
<td class="org-left">XF86Sleep</td>
<td class="org-left">Already working</td>
</tr>

<tr>
<td class="org-left">F2</td>
<td class="org-left">XF86MonBrightnessDown</td>
<td class="org-left">bound</td>
</tr>

<tr>
<td class="org-left">F3</td>
<td class="org-left">XF86MonBrightnessUp</td>
<td class="org-left">bound</td>
</tr>

<tr>
<td class="org-left">F4</td>
<td class="org-left">XF86Display</td>
<td class="org-left">unbound</td>
</tr>

<tr>
<td class="org-left">F5</td>
<td class="org-left">XF86Mail</td>
<td class="org-left">bound</td>
</tr>

<tr>
<td class="org-left">F6</td>
<td class="org-left">XF86MyComputer</td>
<td class="org-left">bound</td>
</tr>

<tr>
<td class="org-left">F7</td>
<td class="org-left">XF86AudioMute</td>
<td class="org-left">bound</td>
</tr>

<tr>
<td class="org-left">F8</td>
<td class="org-left">XF86AudioLowerVolume</td>
<td class="org-left">bound</td>
</tr>

<tr>
<td class="org-left">F9</td>
<td class="org-left">XF86AudioRaiseVolume</td>
<td class="org-left">bound</td>
</tr>

<tr>
<td class="org-left">F10</td>
<td class="org-left">XF86AudioPrev</td>
<td class="org-left">bound</td>
</tr>

<tr>
<td class="org-left">F11</td>
<td class="org-left">XF86AudioPlay</td>
<td class="org-left">bound</td>
</tr>

<tr>
<td class="org-left">F12</td>
<td class="org-left">XF86AudioNext</td>
<td class="org-left">bound</td>
</tr>
</tbody>
</table>
</div>
<ul class="org-ul">
<li><a id="orgb248579"></a>Media<br>
<div class="outline-text-5" id="text-orgb248579">
<div class="org-src-container">
<pre class="src src-lisp">(define-key *top-map* (kbd <span class="org-string">"s-F7"</span>) <span class="org-string">"exec pactl -- set-sink-mute @DEFAULT_SINK@ toggle"</span>)
(define-key *top-map* (kbd <span class="org-string">"s-F8"</span>) <span class="org-string">"exec pactl -- set-sink-volume @DEFAULT_SINK@ -1%"</span>)
(define-key *top-map* (kbd <span class="org-string">"s-F9"</span>) <span class="org-string">"exec pactl -- set-sink-volume @DEFAULT_SINK@ +1%"</span>)
(define-key *top-map* (kbd <span class="org-string">"s-F10"</span>) <span class="org-string">"exec playerctl previous"</span>)
(define-key *top-map* (kbd <span class="org-string">"s-F11"</span>) <span class="org-string">"exec playerctl play-pause"</span>)
(define-key *top-map* (kbd <span class="org-string">"s-F12"</span>) <span class="org-string">"exec playerctl next"</span>)
</pre>
</div>
</div>
</li>
<li><a id="org3262023"></a>Brightneess<br>
<div class="outline-text-5" id="text-org3262023">
<div class="org-src-container">
<pre class="src src-lisp">(define-key *top-map* (kbd <span class="org-string">"C-s-F2"</span>) <span class="org-string">"exec brightnessctl set 1%-"</span>)
(define-key *top-map* (kbd <span class="org-string">"C-s-F3"</span>) <span class="org-string">"exec brightnessctl set +1%"</span>)
</pre>
</div>
</div>
</li>
</ul>
</div>
<div id="outline-container-orgeda95e5" class="outline-4">
<h4 id="orgeda95e5">Remapped Keys</h4>
<div class="outline-text-4" id="text-orgeda95e5">
<p>
The <code>define-remapped-keys</code> function can be configured to translate certain familiar top level keybindings to alternative key sequences that are understood by specific applications. One example is to force the <i>Emacs</i> keybinding <code>C-n</code> and <code>C-p</code> to move up and down for any specified application. To use the original application we can use <code>send-raw-key</code>. And for temporarily disable all remapped keys, set the <code>*remapped-keys-enabled-p*</code> to nil.
</p>
<div class="org-src-container">
<pre class="src src-lisp">(define-remapped-keys
    `((,(<span class="org-keyword">lambda</span> (win)
          (string-equal <span class="org-string">"Firefox"</span> (window-class win)))
        (<span class="org-string">"C-n"</span>   . <span class="org-string">"Down"</span>)
        (<span class="org-string">"C-p"</span>   . <span class="org-string">"Up"</span>)
        (<span class="org-string">"C-f"</span>   . <span class="org-string">"Right"</span>)
        (<span class="org-string">"C-b"</span>   . <span class="org-string">"Left"</span>)
        (<span class="org-string">"C-v"</span>   . <span class="org-string">"Next"</span>)
        (<span class="org-string">"M-v"</span>   . <span class="org-string">"Prior"</span>)
        (<span class="org-string">"M-w"</span>   . <span class="org-string">"C-c"</span>)
        (<span class="org-string">"C-w"</span>   . <span class="org-string">"C-x"</span>)
        (<span class="org-string">"C-y"</span>   . <span class="org-string">"C-v"</span>)
        (<span class="org-string">"M-&lt;"</span>   . <span class="org-string">"Home"</span>)
        (<span class="org-string">"M-&gt;"</span>   . <span class="org-string">"End"</span>)
        (<span class="org-string">"C-M-b"</span> . <span class="org-string">"M-Left"</span>)
        (<span class="org-string">"C-M-f"</span> . <span class="org-string">"M-Right"</span>)
        (<span class="org-string">"M-f"</span>   . <span class="org-string">"C-Right"</span>)
        (<span class="org-string">"M-b"</span>   . <span class="org-string">"C-Left"</span>)
        (<span class="org-string">"C-k"</span>   . (<span class="org-string">"C-S-End"</span> <span class="org-string">"C-x"</span>)))))
</pre>
</div>
</div>
</div>
<div id="outline-container-orgd72c052" class="outline-4">
<h4 id="orgd72c052">CANCELLED imdb and duckduckgo</h4>
<div class="outline-text-4" id="text-orgd72c052">
<ul class="org-ul">
<li>State &ldquo;CANCELLED&rdquo;  from              <span class="timestamp-wrapper"><span class="timestamp">[2022-04-10 Sun 13:28] </span></span> <br>
not used</li>
</ul>
<p>
This is from the default configuration, I don&rsquo;t use this often.
</p>
<div class="org-src-container">
<pre class="src src-lisp">(define-key *root-map* (kbd <span class="org-string">"M-s"</span>) <span class="org-string">"duckduckgo"</span>)
(define-key *root-map* (kbd <span class="org-string">"i"</span>) <span class="org-string">"imdb"</span>)
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-orgda203f2" class="outline-3">
<h3 id="orgda203f2">Window rules</h3>
<div class="outline-text-3" id="text-orgda203f2">
<p>
First we need to clear the previous rules in order to create a new one.
</p>
<div class="org-src-container">
<pre class="src src-lisp">(clear-window-placement-rules)
</pre>
</div>
</div>
</div>
<div id="outline-container-org801061e" class="outline-3">
<h3 id="org801061e">Frame preferences</h3>
<div class="outline-text-3" id="text-org801061e">
<div class="org-src-container">
<pre class="src src-lisp">(define-frame-preference <span class="org-string">"Term"</span>
  (1 t t <span class="org-builtin">:class</span> <span class="org-string">"XTerm"</span>)
  (1 t t <span class="org-builtin">:class</span> <span class="org-string">"Termite"</span>))

(define-frame-preference <span class="org-string">"Ardour"</span>
  (0 t   t   <span class="org-builtin">:instance</span> <span class="org-string">"ardour_editor"</span> <span class="org-builtin">:type</span> <span class="org-builtin">:normal</span>)
  (0 t   t   <span class="org-builtin">:title</span> <span class="org-string">"Ardour - Session Control"</span>)
  (0 nil nil <span class="org-builtin">:class</span> <span class="org-string">"XTerm"</span>)
  (1 t   nil <span class="org-builtin">:type</span> <span class="org-builtin">:normal</span>)
  (1 t   t   <span class="org-builtin">:instance</span> <span class="org-string">"ardour_mixer"</span>)
  (2 t   t   <span class="org-builtin">:instance</span> <span class="org-string">"jvmetro"</span>)
  (1 t   t   <span class="org-builtin">:instance</span> <span class="org-string">"qjackctl"</span>)
  (3 t   t   <span class="org-builtin">:instance</span> <span class="org-string">"qjackctl"</span> <span class="org-builtin">:role</span> <span class="org-string">"qjackctlMainForm"</span>))

(define-frame-preference <span class="org-string">"Dev"</span>
  (2 t t <span class="org-builtin">:restore</span> <span class="org-string">"emacs-editing-dump"</span> <span class="org-builtin">:title</span> <span class="org-string">"...xdvi"</span>)
  (2 t t <span class="org-builtin">:create</span> <span class="org-string">"emacs-dump"</span> <span class="org-builtin">:class</span> <span class="org-string">"Emacs"</span>))

(define-frame-preference <span class="org-string">"Web"</span>
  (3 t t <span class="org-builtin">:create</span> <span class="org-string">"nyxt-dump"</span> <span class="org-builtin">:class</span> <span class="org-string">"Nyxt"</span>)
  (3 t t <span class="org-builtin">:create</span> <span class="org-string">"firefox-dump"</span> <span class="org-builtin">:class</span> <span class="org-string">"firefox"</span>))

(define-frame-preference <span class="org-string">"Files"</span>
  (4 t t <span class="org-builtin">:create</span> <span class="org-string">"thunar-dump"</span> <span class="org-builtin">:class</span> <span class="org-string">"Thunar"</span>))

(define-frame-preference <span class="org-string">"Message"</span>
  (5 t t <span class="org-builtin">:create</span> <span class="org-string">"telegramdesktop-dump"</span> <span class="org-builtin">:class</span> <span class="org-string">"TelegramDesktop"</span>))

(define-frame-preference <span class="org-string">"Multimedia"</span>
  (6 t t <span class="org-builtin">:create</span> <span class="org-string">"cheese-dump"</span> <span class="org-builtin">:class</span> <span class="org-string">"Cheese"</span>)
  (6 t t <span class="org-builtin">:create</span> <span class="org-string">"spotify-dump"</span> <span class="org-builtin">:class</span> <span class="org-string">"Spotify"</span>)
  (6 t t <span class="org-builtin">:create</span> <span class="org-string">"picard-dump"</span> <span class="org-builtin">:class</span> <span class="org-string">"Picard"</span>)
  (6 t t <span class="org-builtin">:create</span> <span class="org-string">"mpv-dump"</span> <span class="org-builtin">:class</span> <span class="org-string">"mpv"</span>)
  (6 t t <span class="org-builtin">:create</span> <span class="org-string">"vlc-dump"</span> <span class="org-builtin">:class</span> <span class="org-string">"vlc"</span>)
  (6 t t <span class="org-builtin">:create</span> <span class="org-string">"hakuneko-dump"</span> <span class="org-builtin">:class</span> <span class="org-string">"hakuneko-desktop"</span>)
  (6 t t <span class="org-builtin">:create</span> <span class="org-string">"gimp-dump"</span> <span class="org-builtin">:class</span> <span class="org-string">"Gimp"</span>))

(define-frame-preference <span class="org-string">"Remote"</span>
  (7 t t <span class="org-builtin">:create</span> <span class="org-string">"virtmanager-dump"</span> <span class="org-builtin">:class</span> <span class="org-string">"Virt-manager"</span>)
  (7 t t <span class="org-builtin">:create</span> <span class="org-string">"vncviewer-dump"</span> <span class="org-builtin">:class</span> <span class="org-string">"Vncviewer"</span>))
</pre>
</div>
</div>
</div>
</section>
<section id="outline-container-org0697892" class="outline-2">
<h2 id="org0697892">Running Stumpwm</h2>
<div class="outline-text-2" id="text-org0697892">
<p>
There are various methods of starting a <i>stumpwm</i> X session. The easiest way is to install the <i>stumpwm</i> package using your <i>distro</i> package manager, then you can run the executable <code>stumpwm</code> using <i>xinit</i>, <i>startx</i>, or via <i>display managers</i>, since the package will likely to also provide a <code>.desktop</code> file.
The other (recommended) way is to clone the official repository<sup><a id="fnr.2" class="footref" href="#fn.2" role="doc-backlink">2</a></sup>, install the required dependencies, build and install <i>stumpwm</i> (usually into <code>/usr/local/</code> so other user can also use it). Then start it by either <i>startx</i> or <i>xinit</i>, or create additional <code>.desktop</code> file so the <i>display manager</i> can also use it.
Other method (the one I use), is to install <i>stumpwm</i> via <i>sbcl</i>
</p>
<div class="org-src-container">
<pre class="src src-lisp">(ql:quickload <span class="org-string">"stumpwm"</span>)
</pre>
</div>
<p>
And create a <code>startstumpwm</code> file in <code>/usr/local/bin</code>:
</p>
<div class="org-src-container">
<pre class="src src-lisp"><span class="org-comment-delimiter">;;;; </span><span class="org-comment">-*-lisp-*-</span>
(<span class="org-keyword">require</span> <span class="org-constant">:stumpwm</span>)
(stumpwm:stumpwm)
</pre>
</div>
<p>
This file then called from <code>~/.xinitrc</code>:
</p>
<div class="org-src-container">
<pre class="src src-sh"><span class="org-keyword">exec</span> sbcl --load /usr/local/bin/startstumpwm
</pre>
</div>
<p>
or if using <i>display manager</i> create a <code>.desktop</code> file:
</p>
<div class="org-src-container">
<pre class="src src-conf">[<span class="org-type">Desktop Entry</span>]
<span class="org-variable-name">Name</span>=StumpWM
<span class="org-variable-name">Type</span>=XSession
<span class="org-variable-name">Exec</span>=/usr/local/bin/sbcl --load /usr/local/bin/startstumpwm
<span class="org-variable-name">Name</span>=StumpWM
<span class="org-variable-name">Comment</span>=Stump window manager
</pre>
</div>
<p>
The <i>display manager</i> itself must be configured to also pick up the <code>/usr/local/share/xsession</code> directory, I prefer to put my own compiled packages in <code>/usr/local</code> to avoid conflict with the ones installed by the <i>distro</i> package manager. Example in <i>lightdm</i> is to add:
</p>
<div class="org-src-container">
<pre class="src src-conf"><span class="org-variable-name">sessions-directory</span>=/usr/share/lightdm/sessions:/usr/share/xsessions:/usr/share/wayland-sessions:/usr/local/share/xsessions
</pre>
</div>
<p>
in the <code>[LightDM]</code> section.
This method, and the method using <i>git</i> repository, has the benefit of having all the dependencies in their latest version. This is useful when using <i>sly</i> or <i>slime</i> in <i>emacs</i>.
</p>
</div>
</section>
<div id="footnotes">
<h2 class="footnotes">Footnotes: </h2>
<div id="text-footnotes">

<div class="footdef"><sup><a id="fn.1" class="footnum" href="#fnr.1" role="doc-backlink">1</a></sup> <div class="footpara" role="doc-footnote"><p class="footpara">
<a href="http://www.lispworks.com/documentation/lw51/CLHS/Body/f_probe_.htm">http://www.lispworks.com/documentation/lw51/CLHS/Body/f_probe_.htm</a>
</p></div></div>

<div class="footdef"><sup><a id="fn.2" class="footnum" href="#fnr.2" role="doc-backlink">2</a></sup> <div class="footpara" role="doc-footnote"><p class="footpara">
<a href="https://github.com/stumpwm/stumpwm">https://github.com/stumpwm/stumpwm</a>
</p>

<script src="https://utteranc.es/client.js"repo="alexforsale/blog" issue-term="pathname" label="utterances" theme="gruvbox-dark" crossorigin="anonymous" async></script></div></div>


</div>
</div></main>
<footer id="postamble" class="status">
<div class='footer'>
  Copyright © 2012-2022 <a href='mailto:alexforsale@yahoo.com'>alexforsale</a> | <a href='https://github.com/alexforsale/blog'>Source</a> <br>
  GnuPG fingerprint: <a href='https://keys.openpgp.org/search?q=27517709E592F14C5A51D90B972B3C2D613E4AE9'>2751 7709 E592 F14C 5A51 D90B 972B 3C2D 613E 4AE9</a> <br>
  Last updated on Jun 07, 2022. Generated using <a href="https://www.gnu.org/software/emacs/">Emacs</a> 26.3 (<a href="https://orgmode.org">Org</a> mode 9.5.4) <br>
  <a href="https://info.flagcounter.com/yNMj"><img src="https://s05.flagcounter.com/mini/yNMj/bg_FFFFFF/txt_000000/border_CCCCCC/flags_0/" alt="Flag Counter" border="0"></a>
</div>
</footer>
</body>
</html>
